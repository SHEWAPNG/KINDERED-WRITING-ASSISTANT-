<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kindred | Say what you mean.</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ù§Ô∏è</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,500&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #FFF5F5;
            --accent-rose: #FF8A8A;
            --text-main: #3D2B2B;
            --glass: rgba(255, 255, 255, 0.6);
        }

        body.dark {
            --bg-main: #1A1616;
            --text-main: #F5EBEB;
            --glass: rgba(45, 38, 38, 0.7);
            background-image: 
                radial-gradient(at 0% 0%, hsla(353,20%,15%,1) 0, transparent 50%), 
                radial-gradient(at 50% 100%, hsla(353,30%,10%,1) 0, transparent 50%) !important;
        }

        body {
            background-color: var(--bg-main);
            background-image: 
                radial-gradient(at 0% 0%, hsla(353,100%,93%,1) 0, transparent 50%), 
                radial-gradient(at 50% 100%, hsla(22,100%,94%,1) 0, transparent 50%);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            transition: all 0.5s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        h1, h2, .serif { font-family: 'Fraunces', serif; letter-spacing: -0.02em; }
        .step-hidden { display: none; }
        .fade-in { animation: fadeIn 0.6s ease forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-lovable {
            background-color: var(--accent-rose);
            color: white;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--text-main);
            color: var(--text-main);
            opacity: 0.6;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .shimmer-btn {
            background: linear-gradient(90deg, #FF8A8A, #ffb3b3, #FF8A8A);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite linear;
        }

        .tone-chip {
            background: white;
            border: 1px solid rgba(61, 43, 43, 0.1);
            color: #3D2B2B;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        body.dark .tone-chip { background: #2D2626; color: white; border-color: rgba(255,255,255,0.1); }
        .tone-chip.active { background-color: var(--accent-rose) !important; color: white !important; border-color: var(--accent-rose) !important; }

        .input-underline {
            background: transparent;
            border: none;
            border-bottom: 2px solid rgba(61, 43, 43, 0.1);
            color: var(--text-main);
            border-radius: 0;
        }
        
        .typing::after {
            content: '|';
            animation: blink 1s infinite;
            color: var(--accent-rose);
        }
        @keyframes blink { 50% { opacity: 0; } }

        #word-count-badge {
            font-size: 10px;
            letter-spacing: 0.05em;
            opacity: 0.4;
            font-weight: 600;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <header class="w-full p-6 md:p-10 flex justify-between items-center z-50">
        <div class="text-xl md:text-2xl serif font-medium cursor-pointer" onclick="window.location.reload()">
            <span class="text-rose-400">‚ù§</span> Kindred
        </div>
        <button onclick="toggleTheme()" class="glass-card p-3 rounded-full hover:scale-110 transition-transform">
            <span id="theme-icon">üåô</span>
        </button>
    </header>

    <main id="app-container" class="flex-grow flex flex-col items-center justify-center w-full px-4 pb-6">
        <div class="w-full max-w-2xl">
            
            <section id="view-home" class="text-center space-y-6 md:space-y-10 fade-in">
                <h1 class="text-4xl md:text-7xl font-medium leading-tight">
                    Find the words <br><span class="italic text-rose-400">your heart</span> wants.
                </h1>
                <p class="text-base md:text-xl opacity-70 max-w-xs md:max-w-lg mx-auto leading-relaxed">
                    Turning "I don't know how to say this" into a simple, human message.
                </p>
                <div class="pt-4">
                    <button onclick="navigateTo('view-flow')" class="btn-lovable px-10 py-4 rounded-full text-base md:text-lg font-medium w-full sm:w-auto">
                        Start Writing
                    </button>
                </div>
            </section>

            <section id="view-about" class="step-hidden text-center space-y-8 fade-in">
                <div class="glass-card p-8 md:p-12 rounded-[3rem] max-w-xl mx-auto shadow-sm">
                    <h2 class="text-3xl md:text-4xl serif mb-6">The Heart Behind Kindred</h2>
                    
                    <div class="space-y-6 text-left opacity-90 leading-relaxed text-sm md:text-base">
                        <p>I‚Äôve noticed something about all of us: <strong>We know exactly what we want to say, but we struggle to find the words to say it.</strong></p>
                        <p>You hear it all the time
                            "I can't really express it, but I know what I mean." There is a gap between the heart and the keyboard. We get so caught up in trying not to sound "awkward" or "rude" that we end up saying nothing at all.</p>
                        <p>I built Kindred to be that bridge. It‚Äôs for the moments when your thoughts are messy, but your intent is clear.</p>
                        <hr class="border-rose-200/30 my-6">
                        <p>I built Kindred because I‚Äôve been there‚Äîstaring at a blinking cursor, feeling the weight of a message that I just couldn't get right.</p>
                        <p>We live in a world of "professional" templates and robotic AI that makes us sound like machines. I wanted something different. I wanted a way to stay <strong>human</strong> even when I‚Äôm behind a screen.</p>
                        <p class="italic text-rose-400">Kindred isn't about perfect grammar; it's about perfect connection.</p>
                        <p>I built this as a bridge for the messy thoughts in our heads, helping them land softly in someone else's heart.</p>
                        <div class="pt-4">
                            <p>Thanks for being part of the story.</p>
                            <p class="serif text-rose-400 text-xl pt-2">Kindred</p>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 border-t border-rose-200/20">
                        <button onclick="navigateTo('view-home')" class="btn-lovable px-10 py-3 rounded-full text-sm font-bold shadow-md">
                            Back to Writing
                        </button>
                    </div>
                </div>
            </section>

            <section id="view-flow" class="step-hidden">
                <div class="glass-card p-6 md:p-10 rounded-[2rem] shadow-xl">
                    <div id="step-1" class="space-y-6">
                        <h2 class="text-2xl md:text-3xl serif">What are you writing?</h2>
                        <input type="text" id="input-what" placeholder="e.g. An email to my boss" class="w-full input-underline py-3 text-xl md:text-2xl outline-none">
                        <div class="flex justify-end"><button onclick="nextStep(2)" class="text-rose-400 font-bold p-2">Next ‚Üí</button></div>
                    </div>

                    <div id="step-2" class="step-hidden space-y-6">
                        <h2 class="text-2xl md:text-3xl serif">Who is receiving this?</h2>
                        <input type="text" id="input-who" placeholder="e.g. Sarah..." class="w-full input-underline py-3 text-xl md:text-2xl outline-none">
                        <div class="flex justify-between items-center">
                            <button onclick="prevStep(1)" class="opacity-50 p-2 text-sm">‚Üê Back</button>
                            <button onclick="nextStep(3)" class="text-rose-400 font-bold p-2">Next ‚Üí</button>
                        </div>
                    </div>

                    <div id="step-3" class="step-hidden space-y-6">
                        <h2 class="text-2xl md:text-3xl serif">What's on your mind?</h2>
                        <textarea id="input-intent" rows="3" placeholder="Just type your messy thoughts..." class="w-full input-underline py-3 text-lg md:text-xl resize-none outline-none"></textarea>
                        <div class="flex justify-between items-center">
                            <button onclick="prevStep(2)" class="opacity-50 p-2 text-sm">‚Üê Back</button>
                            <button onclick="nextStep(4)" class="text-rose-400 font-bold p-2">Next ‚Üí</button>
                        </div>
                    </div>

                    <div id="step-4" class="step-hidden space-y-8 text-center">
                        <h2 class="text-2xl md:text-3xl serif">How should it sound?</h2>
                        <div class="flex flex-wrap justify-center gap-2">
                            <button onclick="selectTone('Professional')" class="tone-chip px-4 py-2 rounded-full text-xs md:text-sm">Professional</button>
                            <button onclick="selectTone('Friendly')" class="tone-chip px-4 py-2 rounded-full text-xs md:text-sm">Friendly</button>
                            <button onclick="selectTone('Direct')" class="tone-chip px-4 py-2 rounded-full text-xs md:text-sm">Direct</button>
                            <button onclick="selectTone('Creative')" class="tone-chip px-4 py-2 rounded-full text-xs md:text-sm">Creative</button>
                            <button onclick="selectTone('Kind')" class="tone-chip px-4 py-2 rounded-full text-xs md:text-sm">Kind</button>
                        </div>
                        <input type="hidden" id="input-tone" value="Professional">
                        <button id="generate-btn" onclick="generateWriting()" class="btn-lovable text-white px-8 py-4 rounded-full text-base font-bold w-full mt-4">
                            Keep it simple
                        </button>
                    </div>
                </div>
            </section>

            <section id="view-result" class="step-hidden">
                <div class="glass-card p-6 md:p-10 rounded-[2.5rem]">
                    <div class="flex justify-between items-center mb-4">
                        <span id="word-count-badge">0 Words</span>
                        <span class="text-[10px] opacity-30 font-bold tracking-widest">KINDRED SPIRIT</span>
                    </div>
                    <div id="output-text" class="text-lg md:text-xl leading-relaxed serif min-h-[150px] whitespace-pre-wrap"></div>
                    
                    <div class="mt-8 pt-6 border-t border-rose-200/20 flex flex-col gap-3">
                        <div class="flex flex-col sm:flex-row gap-3 w-full">
                            <button onclick="copyToClipboard()" id="copy-btn" class="btn-lovable flex-grow px-6 py-4 rounded-xl text-sm md:text-base font-bold">Copy Text</button>
                            <button onclick="shareWhatsApp()" class="bg-[#25D366] text-white px-6 py-4 rounded-xl text-sm font-bold flex items-center justify-center gap-2">
                                Share to WhatsApp
                            </button>
                        </div>
                        <button onclick="navigateTo('view-flow')" id="regen-btn" class="btn-outline w-full px-6 py-4 rounded-xl text-xs md:text-sm font-bold">Try Again ‚Üª</button>
                    </div>
                    <button onclick="window.location.reload()" class="w-full text-center text-[10px] uppercase tracking-widest opacity-40 mt-6">Start New Draft</button>
                </div>
            </section>
        </div>

        <footer class="w-full py-6 text-center">
            <button onclick="navigateTo('view-about')" class="text-xs opacity-40 hover:opacity-100 transition-opacity uppercase tracking-widest font-bold">
                Why I Built Kindred
            </button>
        </footer>
    </main>

    <script>
    const API_URL = "/api/generate";
    let currentStep = 1;

    function toggleTheme() {
        document.body.classList.toggle('dark');
        const isDark = document.body.classList.contains('dark');
        document.getElementById('theme-icon').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
        localStorage.setItem('kindred-theme', isDark ? 'dark' : 'light');
    }

    if (localStorage.getItem('kindred-theme') === 'dark') {
        document.body.classList.add('dark');
        document.getElementById('theme-icon').textContent = '‚òÄÔ∏è';
    }

    function navigateTo(viewId) {
        document.querySelectorAll('main section').forEach(s => s.classList.add('step-hidden'));
        document.getElementById(viewId).classList.remove('step-hidden');
        window.scrollTo(0,0);
    }

    function nextStep(step) {
        document.getElementById(`step-${currentStep}`).classList.add('step-hidden');
        document.getElementById(`step-${step}`).classList.remove('step-hidden');
        currentStep = step;
    }

    function prevStep(step) {
        document.getElementById(`step-${currentStep}`).classList.add('step-hidden');
        document.getElementById(`step-${step}`).classList.remove('step-hidden');
        currentStep = step;
    }

    function selectTone(tone) {
        document.getElementById('input-tone').value = tone;
        document.querySelectorAll('.tone-chip').forEach(btn => {
            btn.classList.toggle('active', tone === btn.textContent);
        });
    }

    function typeWriter(text, elementId, speed = 8) {
        const element = document.getElementById(elementId);
        element.textContent = "";
        element.classList.add('typing');
        let i = 0;
        function type() {
            if (i < text.length) {
                element.textContent += text.charAt(i);
                i++;
                const count = element.textContent.trim() ? element.textContent.trim().split(/\s+/).length : 0;
                document.getElementById('word-count-badge').textContent = `${count} Words`;
                setTimeout(type, speed);
            } else {
                element.classList.remove('typing');
            }
        }
        type();
    }

    async function generateWriting() {
        const btn = document.getElementById('generate-btn');
        const what = document.getElementById('input-what').value.trim();
        const intent = document.getElementById('input-intent').value.trim();
        const who = document.getElementById('input-who').value.trim();
        const tone = document.getElementById('input-tone').value;

        if (!what && !intent) {
            alert("Give Kindred a few details first!");
            return;
        }

        btn.disabled = true;
        btn.classList.add('shimmer-btn');
        btn.innerHTML = "Thinking like a human...";

        try {
            const res = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    userQuery: `Task: Draft ${what} to ${who}. Details: ${intent}`, 
                    systemPrompt: tone 
                })
            });

            if (!res.ok) throw new Error("Server error");

            const data = await res.json();
            navigateTo('view-result');
            typeWriter(data.text.trim(), 'output-text');
        } catch (err) {
            alert("Connection error. Make sure your server is running!");
        } finally {
            btn.disabled = false;
            btn.classList.remove('shimmer-btn');
            btn.innerHTML = "Keep it simple";
        }
    }

    function copyToClipboard() {
        navigator.clipboard.writeText(document.getElementById('output-text').textContent).then(() => {
            const btn = document.getElementById('copy-btn');
            btn.textContent = "Saved to clipboard! ‚ú®";
            setTimeout(() => btn.textContent = "Copy Text", 2000);
        });
    }

    function shareWhatsApp() {
        const text = document.getElementById('output-text').textContent;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }
    </script>
</body>
</html>

